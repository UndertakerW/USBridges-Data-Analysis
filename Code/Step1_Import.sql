-- construct the table of the raw data
drop table if exists rawdata;
create table rawdata(
STATE_CODE_001 varchar(50),
STRUCTURE_NUMBER_008 varchar(50),
RECORD_TYPE_005A varchar(50),
ROUTE_PREFIX_005B varchar(50),
SERVICE_LEVEL_005C varchar(50),
ROUTE_NUMBER_005D varchar(50),
DIRECTION_005E varchar(50),
HIGHWAY_DISTRICT_002 varchar(50),
COUNTY_CODE_003 varchar(50),
PLACE_CODE_004 varchar(50),
FEATURES_DESC_006A varchar(50),
CRITICAL_FACILITY_006B varchar(50),
FACILITY_CARRIED_007 varchar(50),
LOCATION_009 varchar(50),
MIN_VERT_CLR_010 varchar(50),
KILOPOINT_011 varchar(50),
BASE_HWY_NETWORK_012 varchar(50),
LRS_INV_ROUTE_013A varchar(50),
SUBROUTE_NO_013B varchar(50),
LAT_016 varchar(50),
LONG_017 varchar(50),
DETOUR_KILOS_019 varchar(50),
TOLL_020 varchar(50),
MAINTENANCE_021 varchar(50),
OWNER_022 varchar(50),
FUNCTIONAL_CLASS_026 varchar(50),
YEAR_BUILT_027 varchar(50),
TRAFFIC_LANES_ON_028A varchar(50),
TRAFFIC_LANES_UND_028B varchar(50),
ADT_029 varchar(50),
YEAR_ADT_030 varchar(50),
DESIGN_LOAD_031 varchar(50),
APPR_WIDTH_MT_032 varchar(50),
MEDIAN_CODE_033 varchar(50),
DEGREES_SKEW_034 varchar(50),
STRUCTURE_FLARED_035 varchar(50),
RAILINGS_036A varchar(50),
TRANSITIONS_036B varchar(50),
APPR_RAIL_036C varchar(50),
APPR_RAIL_END_036D varchar(50),
HISTORY_037 varchar(50),
NAVIGATION_038 varchar(50),
NAV_VERT_CLR_MT_039 varchar(50),
NAV_HORR_CLR_MT_040 varchar(50),
OPEN_CLOSED_POSTED_041 varchar(50),
SERVICE_ON_042A varchar(50),
SERVICE_UND_042B varchar(50),
STRUCTURE_KIND_043A varchar(50),
STRUCTURE_TYPE_043B varchar(50),
APPR_KIND_044A varchar(50),
APPR_TYPE_044B varchar(50),
MAIN_UNIT_SPANS_045 varchar(50),
APPR_SPANS_046 varchar(50),
HORR_CLR_MT_047 varchar(50),
MAX_SPAN_LEN_MT_048 varchar(50),
STRUCTURE_LEN_MT_049 varchar(50),
LEFT_CURB_MT_050A varchar(50),
RIGHT_CURB_MT_050B varchar(50),
ROADWAY_WIDTH_MT_051 varchar(50),
DECK_WIDTH_MT_052 varchar(50),
VERT_CLR_OVER_MT_053 varchar(50),
VERT_CLR_UND_REF_054A varchar(50),
VERT_CLR_UND_054B varchar(50),
LAT_UND_REF_055A varchar(50),
LAT_UND_MT_055B varchar(50),
LEFT_LAT_UND_MT_056 varchar(50),
DECK_COND_058 varchar(50),
SUPERSTRUCTURE_COND_059 varchar(50),
SUBSTRUCTURE_COND_060 varchar(50),
CHANNEL_COND_061 varchar(50),
CULVERT_COND_062 varchar(50),
OPR_RATING_METH_063 varchar(50),
OPERATING_RATING_064 varchar(50),
INV_RATING_METH_065 varchar(50),
INVENTORY_RATING_066 varchar(50),
STRUCTURAL_EVAL_067 varchar(50),
DECK_GEOMETRY_EVAL_068 varchar(50),
UNDCLRENCE_EVAL_069 varchar(50),
POSTING_EVAL_070 varchar(50),
WATERWAY_EVAL_071 varchar(50),
APPR_ROAD_EVAL_072 varchar(50),
WORK_PROPOSED_075A varchar(50),
WORK_DONE_BY_075B varchar(50),
IMP_LEN_MT_076 varchar(50),
DATE_OF_INSPECT_090 varchar(50),
INSPECT_FREQ_MONTHS_091 varchar(50),
FRACTURE_092A varchar(50),
UNDWATER_LOOK_SEE_092B varchar(50),
SPEC_INSPECT_092C varchar(50),
FRACTURE_LAST_DATE_093A varchar(50),
UNDWATER_LAST_DATE_093B varchar(50),
SPEC_LAST_DATE_093C varchar(50),
BRIDGE_IMP_COST_094 varchar(50),
ROADWAY_IMP_COST_095 varchar(50),
TOTAL_IMP_COST_096 varchar(50),
YEAR_OF_IMP_097 varchar(50),
OTHER_STATE_CODE_098A varchar(50),
OTHER_STATE_PCNT_098B varchar(50),
OTHR_STATE_STRUC_NO_099 varchar(50),
STRAHNET_HIGHWAY_100 varchar(50),
PARALLEL_STRUCTURE_101 varchar(50),
TRAFFIC_DIRECTION_102 varchar(50),
TEMP_STRUCTURE_103 varchar(50),
HIGHWAY_SYSTEM_104 varchar(50),
FEDERAL_LANDS_105 varchar(50),
YEAR_RECONSTRUCTED_106 varchar(50),
DECK_STRUCTURE_TYPE_107 varchar(50),
SURFACE_TYPE_108A varchar(50),
MEMBRANE_TYPE_108B varchar(50),
DECK_PROTECTION_108C varchar(50),
PERCENT_ADT_TRUCK_109 varchar(50),
NATIONAL_NETWORK_110 varchar(50),
PIER_PROTECTION_111 varchar(50),
BRIDGE_LEN_IND_112 varchar(50),
SCOUR_CRITICAL_113 varchar(50),
FUTURE_ADT_114 varchar(50),
YEAR_OF_FUTURE_ADT_115 varchar(50),
MIN_NAV_CLR_MT_116 varchar(50),
FED_AGENCY varchar(50),
DATE_LAST_UPDATE varchar(50),
TYPE_LAST_UPDATE varchar(50),
DEDUCT_CODE varchar(50),
REMARKS varchar(50),
PROGRAM_CODE varchar(50),
PROJ_NO varchar(50),
PROJ_SUFFIX varchar(50),
NBI_TYPE_OF_IMP varchar(50),
DTL_TYPE_OF_IMP varchar(50),
SPECIAL_CODE varchar(50),
STEP_CODE varchar(50),
STATUS_WITH_10YR_RULE varchar(50),
SUFFICIENCY_ASTERC varchar(50),
SUFFICIENCY_RATING varchar(50),
STATUS_NO_10YR_RULE varchar(50),
CAT10 varchar(50)
);
--

set global max_allowed_packet = 1024*1024*1024;

set global max_execution_time = 0;

set sql_safe_updates = 0;

-- the original raw data is converted into utf-8 encoding
load data infile 'D:/CUHK/Y3T1/ERG3010/ERG3010-Project/Data/rawdata-usbridges-csv-2016-utf8.csv'   
into table rawdata
fields terminated by ','  optionally enclosed by '"' escaped by '"'   
lines terminated by '\r\n'; 